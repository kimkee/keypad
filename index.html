<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Shuffle KEYPAD</title>
    <link rel="stylesheet" href="./style.css">
</head>
<body>

<div class="keypad">
    <div class="dots">
        <div class="txt">PIN</div>
        <div class="dbx"></div>
    </div>
    <div class="keys">
        <div class="kbx"></div>
    </div>
</div>

<script>
const keypad = {
    init: function(){
        this.kset();
    },
    cnum: 0,
    pnum: 6, /* 비번갯수 */
    dset: function(n){ /* 점들 그리기 */
        const dbox = document.querySelector(".dots .dbx");
        let dot = '';
        for(let d = 0; d < this.pnum; d++){
            n > d ? ac = 'on' : ac = '';
            dot += '<em class="dt '+ac+'"></em>';
        }
        dbox.innerHTML = dot;
        if( this.cnum >= this.pnum){
            this.cnum = this.pnum;
            this.pcom();
        };
        console.log(this.cnum);
    },
    kset: function(c){ /* 번호 그리기 */
        const kbox = document.querySelector(".keys .kbx");
        const norg = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9];
        const nums = [...norg];
        const choc = e => nums.splice( Math.floor( Math.random()*nums.length ) , 1)[0]; /* 랜덤 뽑기  arrs.sort( e => Math.random() - 0.5 )  */
        let bts= '';
        let bn = '';
        let bx = '<button type="button" class="bt del"><i>Del</i></button>';
        let bc = '<button type="button" class="bt rst"><i>Reset</i></button>';
        for(let i in norg){
            let pp = choc();
            let bt = '<button type="button" value="' + pp + '" class="bt num"><i>' + pp + '</i></button>';
            console.log(i, pp, nums);
            i == 8 ? bn = bc : null;
            i == 9 ? bn = bx : null;
            bts += bt + bn;
        }
        kbox.innerHTML = bts;
        this.dset(0);
        this.cnum = 0;
        kbox.querySelectorAll(".bt").forEach( bt => bt.addEventListener("click", e => {
            bt.classList.contains("num") && this.pset(bt);
            bt.classList.contains("rst") && this.rset(bt);
            bt.classList.contains("del") && this.pdel(bt);
        }));
    },
    rset: function(){ /* Reset */
        setTimeout( e => this.kset(), 100);
    },
    pdel: function(){ /* Del */
        this.cnum--;
        this.cnum < 0 ? this.cnum = 0 : null;
        this.dset(this.cnum);
    },
    pset: function(bt){ /* Number */
        this.cnum++ ;
        this.dset(this.cnum, bt.value);
    },
    pcom: e => setTimeout( e => location.reload(), 100 )  /* 모두 입력 후 */
};

document.addEventListener('DOMContentLoaded', e => keypad.init() );
</script>

</body>
</html>